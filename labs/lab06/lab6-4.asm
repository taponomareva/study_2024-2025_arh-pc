;--------------------------------
; Программа вычисления выражения y = (2 + x)^2
;--------------------------------
%include 'in_out.asm' ; подключение внешнего файла

SECTION .data
msg DB 'Введите значение x: ', 0 ; сообщение запроса на ввод
result_msg DB 'Результат: ', 0 ; сообщение с результатом
SECTION .bss
x resb 4 ; резервируем место для переменной x (предположим, что x целое)

SECTION .text
GLOBAL _start
_start:

    ; ---- Вывод запроса на ввод
    mov eax, msg
    call sprintLF ; печатаем запрос "Введите значение x: "

    ; ---- Ввод значения x с клавиатуры
    mov eax, x     ; Адрес переменной x
    mov ecx, x     ; Указатель на переменную x (буфер ввода)
    mov edx, 80    ; Размер буфера (максимальная длина ввода)
    call sread     ; Чтение строки с клавиатуры

    ; ---- Преобразуем строку в число
    ; Допустим, что вводим 1 цифру (первый символ строки - число)
    mov al, [x]    ; Загружаем первый символ (предполагаем, что это цифра)
    sub al, '0'     ; Преобразуем символ в число (например, '3' -> 3)
    mov eax, edx   ; Сохраняем значение x в eax

    ; ---- Вычисляем (x + 2) ^ 2
    add eax, 2      ; EAX = x + 2
    mov ebx, eax    ; Сохраняем (x + 2) в ebx
    mul ebx         ; EAX = (x + 2) * (x + 2)

    ; ---- Вывод результата
    mov eax, result_msg
    call sprintLF   ; Печатаем сообщение "Результат: "
    mov eax, ebx    ; Результат в ebx
    call iprintLF   ; Выводим результат

    call quit       ; Завершаем программу

